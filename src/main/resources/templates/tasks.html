<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Tasks</title>
</head>
<body>
<h1>All Tasks</h1>


<div class="search-section">

    <!-- Search by Title -->
    <form th:action="@{/tasks/search}" method="get">
        <input type="text"
               name="keyword"
               placeholder="Search by title"
               minlength="1"
               maxlength="100"
               required />
        <button type="submit">Search</button>
    </form>

    <!-- Filter by Status -->
    <form th:action="@{/tasks/status}" method="get">
        <select name="status" required>
            <option value="">-- Status --</option>
            <option value="Pending">Pending</option>
            <option value="In Progress">In Progress</option>
            <option value="Completed">Completed</option>
        </select>
        <button type="submit">Filter</button>
    </form>

    <!-- Filter by Priority -->
    <form th:action="@{/tasks/priority}" method="get">
        <select name="priority" required>
            <option value="">-- Priority --</option>
            <option value="Low">Low</option>
            <option value="Medium">Medium</option>
            <option value="High">High</option>
        </select>
        <button type="submit">Filter</button>
    </form>

    <!-- Filter by Due Date -->
    <form th:action="@{/tasks/due}" method="get">
        <input type="date" name="date" required />
        <button type="submit">Filter</button>
    </form>

</div>


<table border="1">
    <thead>
    <tr>
        <th>Id</th>
        <th>Title</th>
        <th>Description</th>
        <th>Due Date</th>
        <th>Status</th>
        <th>Priority</th>
        <th>Created At</th>
        <th>Updated</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="task : ${tasks}">
        <td th:text="${task.id}"></td>
        <td th:text="${task.title}"></td>
        <td th:text="${task.description}"></td>
        <td th:text="${task.dueDate}"></td>
        <td th:text="${task.status}"></td>
        <td th:text="${task.priority}"></td>
        <td th:text="${task.createdAt}"></td>

        <td th:text="${task.updated ? 'Updated' : 'New'}"></td>
        <td>
            <a th:href="@{/tasks/edit/{id}(id=${task.id})}">Edit</a>
            <a th:href="@{/tasks/delete/{id}(id=${task.id})}"
               onclick="return confirm('Delete task?')">Delete</a>
            <a th:href="@{/tasks/markdown/{id}(id=${task.id})}">
                Mark Done
            </a>
        </td>

    </tr>
    </tbody>
</table>

<a th:href="@{/tasks/add}">Add another task</a>



</body>
</html>
